<%= render DS::Dialog.new do |dialog| %>
  <% dialog.with_header(title: t("properties.new.manually")) %>
  <% dialog.with_body do %>
    <div class="flex gap-4">
      <!-- Left sidebar with tabs -->
      <%= render "properties/form_tabs", account: @account, active_tab: "address" %>

      <!-- Right content area with form -->
      <div class="flex-1">
        <%= styled_form_with model: @property, url: update_address_property_path(@account), method: :patch, data: { turbo_frame: @property.address.persisted? ? nil : :_top } do |form| %>
          <div class="flex flex-col gap-2 min-h-[320px]">
            <%= render "properties/form_alert", notice: @success_message, error: @error_message %>

            <%= form.fields_for :address do |address_form| %>
              <%= address_form.text_field :line1,
                    label: t("properties.form.address_line1_label"),
                    placeholder: t("properties.form.address_line1_placeholder") %>

              <div class="flex items-center gap-2">
                <%= address_form.text_field :locality,
                      label: t("properties.form.city_label"),
                      placeholder: t("properties.form.locality_placeholder") %>
                <%= address_form.text_field :region,
                      label: t("properties.form.state_region"),
                      placeholder: t("properties.form.region_placeholder") %>
              </div>

              <div class="flex items-center gap-2">
                <%= address_form.text_field :postal_code,
                      label: t("properties.form.postal_code_label"),
                      placeholder: t("properties.form.postal_code_placeholder") %>
                <%= address_form.text_field :country,
                      label: t("properties.form.country_label"),
                      placeholder: t("properties.form.country_placeholder") %>
              </div>
            <% end %>
          </div>

          <!-- Save button -->
          <div class="flex justify-between mt-4">
            <% if @account.active? && @success_message %>
              <%= render DS::Button.new(
                text: t("actions.done"),
                href: account_path(@account),
                variant: "outline",
                data: { turbo_frame: "_top" }
              ) %>
            <% end %>
            
            <div class="ml-auto">
              <%= render DS::Button.new(
                text: t("actions.save"),
                variant: "primary",
              ) %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
<% end %>
